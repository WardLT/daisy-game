<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
          integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <title>The Dolly Game!</title>
</head>

<body>

<!-- Begin page content -->
<main role="main" class="container">
    <h1 class="mt-5">The Dolly Game</h1>

    {% with messages = get_flashed_messages(category_filter="message") %}
    {% if messages %}
    {% for message in messages %}
    <div class="alert alert-primary" role="alert">
        {{message}}
    </div>
    {% endfor %}
    {% endif %}
    {% endwith %}

    {% with messages = get_flashed_messages(category_filter="error") %}
    {% if messages %}
    {% for message in messages %}
    <div class="alert alert-danger" role="alert">
        {{message}}
    </div>
    {% endfor %}
    {% endif %}
    {% endwith %}


    <p class="lead">Embark was able to catch the breed(s) of all of Dolly’s ancestors, determining a fraction of Dolly’s
        heritage to each breed. Your task is to guess what those breeds are. Assign a percentage below to guess what
        breeds Dolly is a perfect mix of.</p>

    <p><a class="btn btn-primary" href="guesses" role="button">See everyone's guesses</a></p>

    {% if done %}
    <p><a class="btn btn-success" href="results" role="button">See the results!</a></p>
    {% endif %}

    <h2>Helpful Material</h2>

    <p>In case may not have met Dolly yet, we've collected some
        <a href="https://photos.app.goo.gl/eb339vX9Cq4Q71Cs7">pictures of her</a>
        and compiled some of her key statistics:
    </p>

    <p><ul>
        <li><b>Age</b>: 7 years, from what our vets can guess</li>
        <li><b>Weight</b>: 55 lbs</li>
        <li><b>Color</b>: Ink black, except a gray muzzle and racing stripe along belly.</li>
        <li><b>Fur</b>: Thin but water-repellent</li>
        <li><b>Bark</b>: Rarely used and deep</li>
        <li><b>Top Speed</b>: 20ish mph</li>
        <li><b>Avg. Speed</b>: 0 mph (asleep)</li>
        <li><b>Biggest Love</b>: Splishing in a creek</li>
        <li><b>Biggest Fear</b>: Fireworks</li>
    </ul></p>

    <h2>The Rules</h2>

    <p>We have a few different awards we are giving out. All, except the bonus game, are scored off how you assign
        Dolly's breed.</p>

    <h4>Best Match</h4>

    <p>The big prize will be denoted based on the overlap between your breed distribution and the true one. We will sum
        the difference between your guess and Dolly’s actual fraction for all breeds then give you a score
        reflecting your disagreement. Lowest score wins the Grand Master of the Dolly Game prize.</p>

    <p>Logan, being who he is, based this metric on a way for describing differences between probability distributions:
        <a href="https://en.wikipedia.org/wiki/Kullback%E2%80%93Leibler_divergence">Kullback–Leibler divergence</a>.
        If you disagree with this approach, come over to Atlanta to fight him.
        Maybe you can eat some pie and pet Dolly after.
    </p>

    <h4>Most Breed(s) Correct</h4>

    <p>A simpler game: just get the breed(s) of Dolly correct. Gain one point for correctly guessing a breed, and lose
        one for guessing a breed she is not. The person(s) with the most points (assuredly, one of you will argue a way
        that favors yourself) win the Coward Knowitall Prize.</p>

    <h4>Most Red-Herrings Fallen For</h4>

    <p>The list of breeds contains far more breeds than make up our Dolly (or does it!?). Fall for the most wrong
        ones, and you are the Grand Loser of the Game.</p>

    <h2>The Game!</h2>

    {% with messages = get_flashed_messages(category_filter=["error"]) %}
    {% if messages %}
    {% for message in messages %}
    <div class="alert alert-danger" role="alert">
        {{message}}
    </div>
    {% endfor %}
    {% endif %}
    {% endwith %}

    <p>Are you ready!?</p>

    <form class="row gy-2 gx-3 align-items-center" action="." method="post">

        <p><input type="text" id="name" name="name" placeholder="Your name" value="{{session['name']}}" required/></p>

        <h4>Part 1: Assigning Breeds</h4>

        <p>Assign each breed a percentage (values can be between 0 and 100)
            corresponding to how much of Dolly belongs to it.</p>


        {% for breed in breeds %}
        {% set tag = breed | replace(' ', '_') -%}
        <div class="col-sm-3">
            <label class="my-1 mr-2">{{breed}}</label>
            <input type="number" class="form-control" name="{{tag}}" id="{{tag}}" min="0" max="100" value="0">
        </div>
        {% endfor %}


        <h4>Part 2: Make up a Breed</h4>

        <p>Dolly is her own special dog, and she needs a breed name that captures our special she truly is.
            For example, Dolly could be a “Silent Shadow-wag” or a “Donut Hole in Time and Space.”
            Come up with a breed name and if it is the crowd favorite, your true understanding of Dolly will overshadow
            all - though you will have to contend with the Grand Master.
        </p>

        <input class="form-control" type="text" placeholder="Speedy Snoot" id="newbreed" name="newbreed"
               value="{{session['newbreed']}}" required>

        <button type="submit" class="btn btn-primary mb-3">Submit</button>

    </form>
</main>
</body>
</html>
